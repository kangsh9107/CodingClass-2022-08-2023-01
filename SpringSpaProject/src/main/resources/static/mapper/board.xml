<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kang.board.BoardMapper">

	<select id="totList" parameterType="com.kang.board.PageVo" resultType="Integer">
		select count(id) totSize from board
		where id=#{findStr}
		or    subject like '%${findStr}%'
		or    doc like '%${findStr}%'
	</select>

	<select id="select" parameterType="com.kang.board.PageVo" resultType="com.kang.board.BoardVo">
        select sno, id, grp, seq, deep, hit, date_format(nal, '%y-%m-%d') nal,
              (select count(pSno) from boardAtt where pSno=board.sno) attCnt,
              concat( lpad('', deep*3, '&#160;'),
                  case
                    when deep>0 then concat('â””', subject)
                    else subject
                  end
              ) subject
        from board
        WHERE id=#{findStr} OR SUBJECT LIKE '%${findStr}%'
        OR doc LIKE '%${findStr}%'
        order by grp desc, seq asc, deep asc
        limit ${startNo}, ${listSize}
	</select>
	
	<select id="board10" resultType="com.kang.board.BoardVo">
		select * from board
		where deep=0
		order by sno desc
		limit 0, 10
	</select>
	
    <select id='view' parameterType="Integer" resultType="com.kang.board.BoardVo">
        select sno, id, subject, doc, nal, hit, grp, seq, deep from board
        where sno = #{_parameter}
    </select>
    
    <update id='hitUp' parameterType="Integer">
        update board set hit=hit+1 where sno = #{_parameter}
    </update>
    
    <select id='attList' parameterType="Integer" resultType="com.kang.board.AttVo">
        select sno, pSno, oriFile, sysFile
        from boardAtt
        where pSno = #{_parameter}
    </select>
    
    <delete id="attDeleteAll" parameterType="Integer">
    	delete from boardAtt
    	where sno = #{_parameter}
    </delete>
	
</mapper>